{% comment %}
  Nordic Editorial product page.
  Serif/sans contrast, forest green accent, staggered reveal,
  image counter, wipe hover ATC, frosted sticky bar, cart drawer.
{% endcomment %}

{%- assign current_variant = product.selected_or_first_available_variant -%}
{%- assign image_count = product.images.size -%}

<product-page class="pdp full-width" data-section-id="{{ section.id }}" data-product-url="{{ product.url }}">

  {%- comment -%} ======== GALLERY ======== {%- endcomment -%}
  <div class="pdp__media">
    <div class="pdp__media-viewport">
      <div class="pdp__media-track" id="GalleryTrack-{{ section.id }}">
        {%- for image in product.images -%}
          {%- if forloop.first -%}
            {%- assign load_eager = 'eager' -%}
            {%- assign fetch_high = 'high' -%}
          {%- else -%}
            {%- assign load_eager = 'lazy' -%}
            {%- assign fetch_high = 'auto' -%}
          {%- endif -%}
          <figure
            class="pdp__media-slide{% if forloop.first %} is-active{% endif %}"
            data-index="{{ forloop.index0 }}"
          >
            {{- image
              | image_url: width: 1400
              | image_tag:
                  widths: '500, 800, 1100, 1400',
                  sizes: '(min-width: 1024px) 58vw, 100vw',
                  loading: load_eager,
                  fetchpriority: fetch_high,
                  class: 'pdp__media-img',
                  alt: image.alt | default: product.title
            -}}
          </figure>
        {%- endfor -%}
      </div>

      {%- if image_count > 1 -%}
        <div class="pdp__media-counter" aria-hidden="true">
          <span class="pdp__media-current">01</span>
          <span class="pdp__media-sep">/</span>
          <span class="pdp__media-total">{%- if image_count < 10 -%}0{{ image_count }}{%- else -%}{{ image_count }}{%- endif -%}</span>
        </div>

        <div class="pdp__media-arrows">
          <button type="button" class="pdp__arrow pdp__arrow--prev" aria-label="{{ 'product.gallery_prev' | t }}" disabled>
            <svg width="18" height="18" viewBox="0 0 18 18" fill="none"><path d="M11 14L6 9L11 4" stroke="currentColor" stroke-width="1.25"/></svg>
          </button>
          <button type="button" class="pdp__arrow pdp__arrow--next" aria-label="{{ 'product.gallery_next' | t }}">
            <svg width="18" height="18" viewBox="0 0 18 18" fill="none"><path d="M7 14L12 9L7 4" stroke="currentColor" stroke-width="1.25"/></svg>
          </button>
        </div>
      {%- endif -%}
    </div>

    {%- if image_count > 1 -%}
      <div class="pdp__thumbs" role="tablist" aria-label="{{ 'product.gallery_thumbnails' | t }}">
        {%- for image in product.images -%}
          <button
            type="button"
            class="pdp__thumb{% if forloop.first %} is-active{% endif %}"
            role="tab"
            aria-selected="{{ forloop.first }}"
            aria-label="{{ 'product.gallery_image_n' | t: n: forloop.index }}"
            data-index="{{ forloop.index0 }}"
          >
            {{- image | image_url: width: 100, height: 125, crop: 'center' | image_tag: loading: 'lazy', class: 'pdp__thumb-img', alt: '' -}}
            <span class="pdp__thumb-bar"></span>
          </button>
        {%- endfor -%}
      </div>
    {%- endif -%}
  </div>

  {%- comment -%} ======== PRODUCT INFO ======== {%- endcomment -%}
  <div class="pdp__info">
    <div class="pdp__info-inner" id="ProductInfo-{{ section.id }}">

      {%- comment -%} Category label with decorative line {%- endcomment -%}
      {%- if product.type != blank -%}
        <div class="pdp__category reveal" style="--reveal-i:0">
          <span class="pdp__category-line"></span>
          <span class="pdp__category-text label">{{ product.type }}</span>
        </div>
      {%- endif -%}

      {%- comment -%} Title — large serif {%- endcomment -%}
      <h1 class="pdp__title reveal" style="--reveal-i:1">{{ product.title }}</h1>

      {%- comment -%} Price {%- endcomment -%}
      <div class="pdp__price reveal" style="--reveal-i:2" aria-live="polite">
        {%- if current_variant.compare_at_price > current_variant.price -%}
          <span class="pdp__price-now">{{ current_variant.price | money }}</span>
          <s class="pdp__price-was">{{ current_variant.compare_at_price | money }}</s>
          <span class="pdp__price-badge">{{ 'product.on_sale' | t }}</span>
        {%- else -%}
          <span class="pdp__price-now">{{ current_variant.price | money }}</span>
        {%- endif -%}
      </div>

      {%- comment -%} Subtitle {%- endcomment -%}
      {%- if section.settings.show_short_description and product.metafields.descriptors.subtitle.value != blank -%}
        <p class="pdp__subtitle reveal" style="--reveal-i:3">{{ product.metafields.descriptors.subtitle.value }}</p>
      {%- endif -%}

      <hr class="pdp__rule reveal" style="--reveal-i:3">

      {%- comment -%} Variant swatches {%- endcomment -%}
      <variant-selector class="pdp__variants reveal" style="--reveal-i:4" data-section-id="{{ section.id }}" data-product-url="{{ product.url }}">
        {%- for option in product.options_with_values -%}
          <fieldset class="pdp__option" data-option-index="{{ forloop.index0 }}">
            <legend class="pdp__option-legend label">
              {{ option.name }}{%- if option.selected_value != blank -%}
                <span class="pdp__option-selected">{{ option.selected_value }}</span>
              {%- endif -%}
            </legend>

            <div class="pdp__option-values">
              {%- for value in option.values -%}
                {%- assign opt_key = 'option' | append: forloop.parentloop.index -%}
                {%- assign is_picked = false -%}
                {%- if current_variant[opt_key] == value -%}{%- assign is_picked = true -%}{%- endif -%}

                <label class="pdp__swatch{% if is_picked %} is-active{% endif %}" data-value="{{ value | escape }}">
                  <input
                    type="radio"
                    name="option-{{ option.name | handle }}-{{ section.id }}"
                    value="{{ value | escape }}"
                    {% if is_picked %}checked{% endif %}
                    class="visually-hidden"
                  >
                  <span class="pdp__swatch-face">{{ value }}</span>
                </label>
              {%- endfor -%}
            </div>
          </fieldset>
        {%- endfor -%}

        <select name="id" class="visually-hidden" aria-label="{{ 'product.select_variant' | t }}">
          {%- for variant in product.variants -%}
            <option
              value="{{ variant.id }}"
              {% if variant == current_variant %}selected{% endif %}
              {% unless variant.available %}disabled{% endunless %}
              data-available="{{ variant.available }}"
            >{{ variant.title }} - {{ variant.price | money }}</option>
          {%- endfor -%}
        </select>
      </variant-selector>

      {%- comment -%} Add to cart form {%- endcomment -%}
      <product-form class="pdp__form reveal" style="--reveal-i:5">
        {%- form 'product', product, id: 'ProductForm', data-product-id: product.id -%}
          <input type="hidden" name="id" value="{{ current_variant.id }}">

          <div class="pdp__qty">
            <label for="Qty-{{ section.id }}" class="label">{{ 'product.quantity' | t }}</label>
            <div class="pdp__qty-wrap">
              <button type="button" class="pdp__qty-btn" data-quantity-change="-1" aria-label="{{ 'product.decrease_quantity' | t }}">
                <svg width="14" height="14" viewBox="0 0 14 14" fill="none"><path d="M3 7H11" stroke="currentColor" stroke-width="1.25"/></svg>
              </button>
              <input type="number" id="Qty-{{ section.id }}" name="quantity" min="1" value="1" class="pdp__qty-input">
              <button type="button" class="pdp__qty-btn" data-quantity-change="1" aria-label="{{ 'product.increase_quantity' | t }}">
                <svg width="14" height="14" viewBox="0 0 14 14" fill="none"><path d="M7 3V11M3 7H11" stroke="currentColor" stroke-width="1.25"/></svg>
              </button>
            </div>
          </div>

          <button type="submit" class="pdp__atc" {% unless current_variant.available %}disabled{% endunless %}>
            <span class="pdp__atc-label">
              {%- if current_variant.available -%}
                {{ 'product.add_to_cart' | t }}
              {%- else -%}
                {{ 'product.sold_out' | t }}
              {%- endif -%}
            </span>
          </button>

          {%- if section.settings.show_dynamic_checkout -%}
            <div class="pdp__dynamic-checkout">{{ form | payment_button }}</div>
          {%- endif -%}
        {%- endform -%}
      </product-form>

      {%- comment -%} Trust line {%- endcomment -%}
      {%- if section.settings.show_trust_badges -%}
        <div class="pdp__trust reveal" style="--reveal-i:6">
          <span class="pdp__trust-item">{{ section.settings.trust_text_1 | default: 'Free shipping' }}</span>
          <span class="pdp__trust-dot" aria-hidden="true"></span>
          <span class="pdp__trust-item">{{ section.settings.trust_text_2 | default: 'Easy returns' }}</span>
          <span class="pdp__trust-dot" aria-hidden="true"></span>
          <span class="pdp__trust-item">{{ section.settings.trust_text_3 | default: '5-year warranty' }}</span>
        </div>
      {%- endif -%}

      <hr class="pdp__rule reveal" style="--reveal-i:7">

      {%- comment -%} Accordion details {%- endcomment -%}
      <div class="pdp__details reveal" style="--reveal-i:7">
        {%- if product.description != blank -%}
          <details class="pdp__accordion" open>
            <summary class="pdp__accordion-trigger">
              <span class="pdp__accordion-label">{{ 'product.description' | t }}</span>
              <svg class="pdp__accordion-chevron" width="14" height="14" viewBox="0 0 14 14" fill="none" aria-hidden="true"><path d="M3.5 5.25L7 8.75L10.5 5.25" stroke="currentColor" stroke-width="1.25"/></svg>
            </summary>
            <div class="pdp__accordion-body">
              <div class="pdp__accordion-text rte">{{ product.description }}</div>
            </div>
          </details>
        {%- endif -%}

        {%- if section.settings.dimensions_text != blank -%}
          <details class="pdp__accordion">
            <summary class="pdp__accordion-trigger">
              <span class="pdp__accordion-label">{{ 'product.dimensions' | t }}</span>
              <svg class="pdp__accordion-chevron" width="14" height="14" viewBox="0 0 14 14" fill="none" aria-hidden="true"><path d="M3.5 5.25L7 8.75L10.5 5.25" stroke="currentColor" stroke-width="1.25"/></svg>
            </summary>
            <div class="pdp__accordion-body">
              <div class="pdp__accordion-text rte">{{ section.settings.dimensions_text }}</div>
            </div>
          </details>
        {%- endif -%}

        {%- if section.settings.materials_text != blank -%}
          <details class="pdp__accordion">
            <summary class="pdp__accordion-trigger">
              <span class="pdp__accordion-label">{{ 'product.materials' | t }}</span>
              <svg class="pdp__accordion-chevron" width="14" height="14" viewBox="0 0 14 14" fill="none" aria-hidden="true"><path d="M3.5 5.25L7 8.75L10.5 5.25" stroke="currentColor" stroke-width="1.25"/></svg>
            </summary>
            <div class="pdp__accordion-body">
              <div class="pdp__accordion-text rte">{{ section.settings.materials_text }}</div>
            </div>
          </details>
        {%- endif -%}

        {%- if section.settings.shipping_text != blank -%}
          <details class="pdp__accordion">
            <summary class="pdp__accordion-trigger">
              <span class="pdp__accordion-label">{{ 'product.shipping_returns' | t }}</span>
              <svg class="pdp__accordion-chevron" width="14" height="14" viewBox="0 0 14 14" fill="none" aria-hidden="true"><path d="M3.5 5.25L7 8.75L10.5 5.25" stroke="currentColor" stroke-width="1.25"/></svg>
            </summary>
            <div class="pdp__accordion-body">
              <div class="pdp__accordion-text rte">{{ section.settings.shipping_text }}</div>
            </div>
          </details>
        {%- endif -%}

        {%- if section.settings.care_text != blank -%}
          <details class="pdp__accordion">
            <summary class="pdp__accordion-trigger">
              <span class="pdp__accordion-label">{{ 'product.care' | t }}</span>
              <svg class="pdp__accordion-chevron" width="14" height="14" viewBox="0 0 14 14" fill="none" aria-hidden="true"><path d="M3.5 5.25L7 8.75L10.5 5.25" stroke="currentColor" stroke-width="1.25"/></svg>
            </summary>
            <div class="pdp__accordion-body">
              <div class="pdp__accordion-text rte">{{ section.settings.care_text }}</div>
            </div>
          </details>
        {%- endif -%}
      </div>
    </div>
  </div>

  {%- comment -%} Sticky mobile bar {%- endcomment -%}
  <sticky-atc class="pdp__sticky" aria-hidden="true">
    <div class="pdp__sticky-inner">
      <div class="pdp__sticky-meta">
        <span class="pdp__sticky-name">{{ product.title | truncate: 28 }}</span>
        <span class="pdp__sticky-price" aria-live="polite">{{ current_variant.price | money }}</span>
      </div>
      <button type="button" class="pdp__sticky-btn" data-sticky-atc>
        {%- if current_variant.available -%}{{ 'product.add_to_cart' | t }}{%- else -%}{{ 'product.sold_out' | t }}{%- endif -%}
      </button>
    </div>
  </sticky-atc>

  {%- comment -%} Cart drawer {%- endcomment -%}
  <cart-drawer class="drawer" id="CartDrawer" aria-hidden="true" role="dialog" aria-label="{{ 'cart.title' | t }}">
    <div class="drawer__backdrop" data-cart-drawer-close></div>
    <div class="drawer__panel">
      <div class="drawer__head">
        <h2 class="drawer__heading">{{ 'cart.title' | t }}</h2>
        <button type="button" class="drawer__close" data-cart-drawer-close aria-label="{{ 'product.close' | t }}">
          <svg width="18" height="18" viewBox="0 0 18 18" fill="none"><path d="M4 4L14 14M14 4L4 14" stroke="currentColor" stroke-width="1.25"/></svg>
        </button>
      </div>
      <div class="drawer__body" id="CartDrawerBody">
        <p class="drawer__empty">{{ 'product.cart_empty' | t }}</p>
      </div>
      <div class="drawer__foot">
        <a href="{{ routes.cart_url }}" class="drawer__checkout">{{ 'cart.checkout' | t }}</a>
      </div>
    </div>
  </cart-drawer>
</product-page>

{%- comment -%} Variant JSON for JS {%- endcomment -%}
<script type="application/json" id="ProductJSON-{{ section.id }}">{{ product.variants | json }}</script>

{% stylesheet %}
  /* ================================================================
     PDP — Nordic Editorial layout
     ================================================================ */
  .pdp {
    display: grid;
    grid-template-columns: 1fr;
    gap: 0;
  }
  @media (min-width: 1024px) {
    .pdp {
      grid-template-columns: 58fr 42fr;
      gap: var(--space-12);
      max-width: var(--page-width);
      margin: 0 auto;
      padding: var(--space-6) var(--space-10) var(--space-32);
    }
  }

  /* ================================================================
     Staggered reveal animation
     ================================================================ */
  .reveal {
    opacity: 0;
    animation: revealUp 0.8s var(--ease-out-expo) both;
    animation-delay: calc(0.15s + var(--reveal-i, 0) * 0.09s);
  }

  /* ================================================================
     GALLERY
     ================================================================ */
  .pdp__media {
    display: flex;
    flex-direction: column;
    gap: var(--space-3);
    animation: scaleReveal 1s var(--ease-out-expo) both;
  }
  @media (min-width: 1024px) {
    .pdp__media {
      flex-direction: row-reverse;
      gap: var(--space-4);
      position: sticky;
      top: var(--space-6);
      align-self: start;
      max-height: calc(100dvh - var(--space-12));
    }
  }

  .pdp__media-viewport {
    position: relative;
    overflow: hidden;
    background: var(--color-sand);
  }

  .pdp__media-track {
    display: flex;
    overflow-x: auto;
    scroll-snap-type: x mandatory;
    scrollbar-width: none;
    -webkit-overflow-scrolling: touch;
  }
  .pdp__media-track::-webkit-scrollbar { display: none; }

  .pdp__media-slide {
    flex: 0 0 100%;
    scroll-snap-align: start;
    aspect-ratio: 4 / 5;
    margin: 0;
    background: var(--color-sand);
  }

  .pdp__media-img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 1.6s var(--ease-out-quart);
    will-change: transform;
  }
  .pdp__media-viewport:hover .pdp__media-img {
    transform: scale(1.035);
  }

  /* Image counter — editorial "01 / 07" */
  .pdp__media-counter {
    position: absolute;
    bottom: var(--space-5);
    left: var(--space-5);
    display: flex;
    align-items: center;
    gap: 0.4em;
    font-family: var(--font-body);
    font-size: var(--text-2xs);
    font-weight: 500;
    letter-spacing: var(--tracking-wider);
    color: var(--color-ink);
    opacity: 0.55;
    user-select: none;
    z-index: 2;
  }
  .pdp__media-sep { opacity: 0.4; }

  /* Navigation arrows */
  .pdp__media-arrows { display: none; }
  @media (min-width: 1024px) {
    .pdp__media-arrows {
      display: flex;
      gap: 1px;
      position: absolute;
      bottom: var(--space-5);
      right: var(--space-5);
      z-index: 2;
    }
  }

  .pdp__arrow {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 38px;
    height: 38px;
    background: var(--color-linen);
    border: none;
    cursor: pointer;
    color: var(--color-ink);
    transition: background-color var(--duration-fast) var(--ease-smooth),
                color var(--duration-fast) var(--ease-smooth);
  }
  .pdp__arrow:first-child { border-right: 1px solid var(--color-stone); }
  .pdp__arrow:disabled { opacity: 0.25; cursor: default; }
  .pdp__arrow:not(:disabled):hover {
    background: var(--color-ink);
    color: var(--color-linen);
  }

  /* Thumbnails */
  .pdp__thumbs {
    display: flex;
    gap: var(--space-2);
    overflow-x: auto;
    padding: 0 var(--space-5);
    scrollbar-width: none;
  }
  .pdp__thumbs::-webkit-scrollbar { display: none; }

  @media (min-width: 1024px) {
    .pdp__thumbs {
      flex-direction: column;
      overflow-y: auto;
      overflow-x: hidden;
      padding: 0;
      max-height: calc(100dvh - var(--space-12));
      min-width: 64px;
    }
  }

  .pdp__thumb {
    flex: 0 0 auto;
    position: relative;
    width: 52px;
    height: 65px;
    padding: 0;
    border: none;
    background: none;
    cursor: pointer;
    overflow: hidden;
    opacity: 0.45;
    transition: opacity var(--duration-normal) var(--ease-smooth);
  }
  @media (min-width: 1024px) {
    .pdp__thumb { width: 60px; height: 75px; }
  }
  .pdp__thumb.is-active { opacity: 1; }
  .pdp__thumb:hover:not(.is-active) { opacity: 0.75; }

  .pdp__thumb-img { width: 100%; height: 100%; object-fit: cover; }

  /* Active indicator bar */
  .pdp__thumb-bar {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 2px;
    background: var(--color-ink);
    transform: scaleX(0);
    transition: transform var(--duration-normal) var(--ease-out-expo);
  }
  .pdp__thumb.is-active .pdp__thumb-bar { transform: scaleX(1); }

  /* ================================================================
     PRODUCT INFO
     ================================================================ */
  .pdp__info { padding: var(--space-8) var(--space-6) 0; }
  @media (min-width: 1024px) {
    .pdp__info { padding: var(--space-6) 0 0; }
    .pdp__info-inner {
      position: sticky;
      top: var(--space-6);
      max-height: calc(100dvh - var(--space-12));
      overflow-y: auto;
      scrollbar-width: thin;
      scrollbar-color: var(--color-stone) transparent;
      padding-right: var(--space-4);
    }
  }

  /* Category label with decorative line */
  .pdp__category {
    display: flex;
    align-items: center;
    gap: var(--space-4);
    margin-bottom: var(--space-6);
  }
  .pdp__category-line {
    flex: 0 0 32px;
    height: 1px;
    background: var(--color-stone);
  }

  /* Title — large serif */
  .pdp__title {
    font-family: var(--font-heading);
    font-weight: var(--font-heading-weight);
    font-size: var(--text-4xl);
    line-height: var(--leading-tight);
    letter-spacing: var(--tracking-tighter);
    margin-bottom: var(--space-5);
  }

  /* Price */
  .pdp__price {
    display: flex;
    align-items: baseline;
    gap: var(--space-3);
    margin-bottom: var(--space-5);
  }
  .pdp__price-now {
    font-family: var(--font-heading);
    font-size: var(--text-xl);
    font-weight: var(--font-heading-weight);
    letter-spacing: var(--tracking-tight);
    color: var(--color-ink);
  }
  .pdp__price-was { font-size: var(--text-sm); color: var(--color-driftwood); }
  .pdp__price-badge {
    font-size: var(--text-2xs);
    font-weight: 500;
    letter-spacing: var(--tracking-widest);
    text-transform: uppercase;
    color: var(--color-sienna);
  }

  .pdp__subtitle {
    font-size: var(--text-sm);
    color: var(--color-iron);
    line-height: var(--leading-normal);
    max-width: 48ch;
    margin-bottom: var(--space-5);
  }

  .pdp__rule {
    border: none;
    height: 1px;
    background: var(--color-stone);
    opacity: 0.5;
    margin: var(--space-6) 0;
  }

  /* ================================================================
     VARIANT SWATCHES
     ================================================================ */
  .pdp__variants { display: block; }

  .pdp__option { border: none; padding: 0; margin: 0 0 var(--space-6); }
  .pdp__option-legend { display: block; margin-bottom: var(--space-3); }
  .pdp__option-selected { color: var(--color-ink); font-weight: 500; margin-left: 0.5em; }
  .pdp__option-values { display: flex; flex-wrap: wrap; gap: var(--space-2); }

  .pdp__swatch { display: inline-flex; cursor: pointer; }

  .pdp__swatch-face {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 44px;
    height: 44px;
    padding: 0 var(--space-5);
    font-family: var(--font-body);
    font-size: var(--text-xs);
    font-weight: 500;
    letter-spacing: var(--tracking-wide);
    color: var(--color-ink);
    border: 1px solid var(--color-stone);
    background: transparent;
    white-space: nowrap;
    user-select: none;
    transition: border-color var(--duration-normal) var(--ease-smooth),
                background-color var(--duration-normal) var(--ease-smooth),
                color var(--duration-normal) var(--ease-smooth);
  }

  .pdp__swatch.is-active .pdp__swatch-face,
  .pdp__swatch:has(input:checked) .pdp__swatch-face {
    background: var(--color-ink);
    border-color: var(--color-ink);
    color: var(--color-linen);
  }
  .pdp__swatch:hover:not(.is-active) .pdp__swatch-face {
    border-color: var(--color-ink);
  }

  /* ================================================================
     QUANTITY
     ================================================================ */
  .pdp__qty { margin-bottom: var(--space-6); }
  .pdp__qty > .label { display: block; margin-bottom: var(--space-3); }

  .pdp__qty-wrap {
    display: inline-flex;
    align-items: center;
    border: 1px solid var(--color-stone);
  }
  .pdp__qty-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 44px;
    height: 44px;
    background: none;
    border: none;
    cursor: pointer;
    color: var(--color-ink);
    transition: background var(--duration-fast) var(--ease-smooth);
  }
  .pdp__qty-btn:hover { background: var(--color-sand); }

  .pdp__qty-input {
    width: 44px;
    height: 44px;
    text-align: center;
    border: none;
    border-left: 1px solid var(--color-stone);
    border-right: 1px solid var(--color-stone);
    font-size: var(--text-sm);
    font-weight: 500;
    color: var(--color-ink);
    background: transparent;
    -moz-appearance: textfield;
    border-radius: 0;
  }
  .pdp__qty-input::-webkit-inner-spin-button,
  .pdp__qty-input::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }

  /* ================================================================
     ATC BUTTON — forest green with wipe hover
     ================================================================ */
  .pdp__atc {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    min-height: 56px;
    padding: var(--space-4) var(--space-8);
    font-family: var(--font-body);
    font-size: var(--text-2xs);
    font-weight: 500;
    letter-spacing: var(--tracking-widest);
    text-transform: uppercase;
    color: var(--color-parchment);
    background: var(--color-forest);
    border: none;
    cursor: pointer;
    overflow: hidden;
    z-index: 0;
    transition: opacity var(--duration-normal) var(--ease-smooth);
  }
  .pdp__atc::before {
    content: '';
    position: absolute;
    inset: 0;
    background: var(--color-forest-light);
    transform: scaleX(0);
    transform-origin: left center;
    transition: transform 0.55s var(--ease-out-expo);
    z-index: -1;
  }
  .pdp__atc:hover:not(:disabled)::before { transform: scaleX(1); }
  .pdp__atc:disabled { opacity: 0.35; cursor: not-allowed; }
  .pdp__atc:disabled::before { display: none; }
  .pdp__atc.is-loading { pointer-events: none; opacity: 0.6; }
  .pdp__atc.is-added { background: var(--color-brass); }
  .pdp__atc.is-added::before { display: none; }
  .pdp__atc-label { position: relative; z-index: 1; }

  .pdp__dynamic-checkout { margin-top: var(--space-3); }
  .pdp__dynamic-checkout .shopify-payment-button__button { min-height: 56px; }

  /* ================================================================
     TRUST LINE
     ================================================================ */
  .pdp__trust {
    display: flex;
    align-items: center;
    justify-content: center;
    flex-wrap: wrap;
    gap: var(--space-3);
    margin-top: var(--space-8);
    padding: var(--space-5) 0;
  }
  .pdp__trust-item {
    font-size: var(--text-2xs);
    font-weight: 500;
    letter-spacing: var(--tracking-widest);
    text-transform: uppercase;
    color: var(--color-iron);
  }
  .pdp__trust-dot {
    width: 3px;
    height: 3px;
    border-radius: 50%;
    background: var(--color-stone);
  }

  /* ================================================================
     ACCORDION
     ================================================================ */
  .pdp__details { border-top: 1px solid var(--color-stone); }
  .pdp__accordion { border-bottom: 1px solid var(--color-stone); }

  .pdp__accordion-trigger {
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
    padding: var(--space-5) 0;
    cursor: pointer;
    list-style: none;
    user-select: none;
  }
  .pdp__accordion-trigger::-webkit-details-marker { display: none; }
  .pdp__accordion-trigger::marker { display: none; content: ''; }

  .pdp__accordion-label {
    font-family: var(--font-heading);
    font-size: var(--text-md);
    font-weight: var(--font-heading-weight);
    letter-spacing: var(--tracking-tight);
    color: var(--color-ink);
  }

  .pdp__accordion-chevron {
    flex-shrink: 0;
    color: var(--color-driftwood);
    transition: transform var(--duration-normal) var(--ease-out-expo);
  }
  details[open] > .pdp__accordion-trigger .pdp__accordion-chevron {
    transform: rotate(180deg);
  }

  .pdp__accordion-body {
    display: grid;
    grid-template-rows: 0fr;
    transition: grid-template-rows var(--duration-slow) var(--ease-out-expo);
  }
  details[open] > .pdp__accordion-body { grid-template-rows: 1fr; }

  .pdp__accordion-text {
    overflow: hidden;
    padding: 0 0 var(--space-6);
    font-size: var(--text-sm);
    line-height: var(--leading-normal);
    color: var(--color-iron);
  }
  .pdp__accordion-text.rte p { margin-bottom: var(--space-3); }
  .pdp__accordion-text.rte ul,
  .pdp__accordion-text.rte ol { padding-left: var(--space-6); margin-bottom: var(--space-3); }
  .pdp__accordion-text.rte li { margin-bottom: var(--space-1); }

  /* ================================================================
     STICKY MOBILE BAR — frosted glass
     ================================================================ */
  .pdp__sticky {
    display: none;
    position: fixed;
    bottom: 0; left: 0; right: 0;
    z-index: 50;
    background: rgba(240, 235, 227, 0.82);
    backdrop-filter: blur(16px) saturate(180%);
    -webkit-backdrop-filter: blur(16px) saturate(180%);
    border-top: 1px solid rgba(209, 202, 191, 0.5);
    transform: translateY(100%);
    transition: transform var(--duration-normal) var(--ease-out-expo);
  }
  .pdp__sticky.is-visible { transform: translateY(0); }
  @media (max-width: 1023px) { .pdp__sticky { display: block; } }

  .pdp__sticky-inner {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--space-4);
    padding: var(--space-3) var(--space-5);
  }
  .pdp__sticky-meta { display: flex; flex-direction: column; gap: 2px; min-width: 0; }
  .pdp__sticky-name {
    font-family: var(--font-heading);
    font-size: var(--text-sm);
    font-weight: var(--font-heading-weight);
    color: var(--color-ink);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .pdp__sticky-price { font-size: var(--text-xs); color: var(--color-iron); }
  .pdp__sticky-btn {
    flex-shrink: 0;
    padding: var(--space-3) var(--space-6);
    min-height: 44px;
    font-family: var(--font-body);
    font-size: var(--text-2xs);
    font-weight: 500;
    letter-spacing: var(--tracking-widest);
    text-transform: uppercase;
    color: var(--color-parchment);
    background: var(--color-forest);
    border: none;
    cursor: pointer;
    transition: background var(--duration-normal) var(--ease-smooth);
  }
  .pdp__sticky-btn:hover { background: var(--color-forest-light); }

  /* ================================================================
     CART DRAWER
     ================================================================ */
  .drawer { display: none; position: fixed; inset: 0; z-index: 200; }
  .drawer.is-open { display: block; }

  .drawer__backdrop {
    position: absolute;
    inset: 0;
    background: rgba(28, 28, 28, 0.15);
    backdrop-filter: blur(4px);
    -webkit-backdrop-filter: blur(4px);
    cursor: pointer;
    animation: fadeIn var(--duration-normal) var(--ease-smooth);
  }

  .drawer__panel {
    position: absolute;
    top: 0; right: 0; bottom: 0;
    width: min(400px, 88vw);
    background: var(--color-linen);
    display: flex;
    flex-direction: column;
    animation: slideInRight var(--duration-slow) var(--ease-out-expo);
    box-shadow: var(--shadow-lg);
  }

  .drawer__head {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--space-6) var(--space-8);
    border-bottom: 1px solid var(--color-stone);
  }
  .drawer__heading {
    font-family: var(--font-heading);
    font-size: var(--text-xl);
    font-weight: var(--font-heading-weight);
    letter-spacing: var(--tracking-tight);
  }
  .drawer__close {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 36px; height: 36px;
    background: none;
    border: none;
    cursor: pointer;
    color: var(--color-ink);
    transition: opacity var(--duration-fast);
  }
  .drawer__close:hover { opacity: 0.5; }

  .drawer__body { flex: 1; overflow-y: auto; padding: var(--space-8); }
  .drawer__empty {
    text-align: center;
    color: var(--color-driftwood);
    font-size: var(--text-sm);
    font-style: italic;
    padding: var(--space-16) 0;
  }

  .drawer__item {
    display: grid;
    grid-template-columns: 64px 1fr;
    gap: var(--space-4);
    padding: var(--space-4) 0;
    border-bottom: 1px solid var(--color-stone);
  }
  .drawer__item-image { aspect-ratio: 4 / 5; object-fit: cover; background: var(--color-sand); }
  .drawer__item-info { display: flex; flex-direction: column; gap: 2px; }
  .drawer__item-title {
    font-family: var(--font-heading);
    font-size: var(--text-sm);
    font-weight: var(--font-heading-weight);
    color: var(--color-ink);
    text-decoration: none;
  }
  .drawer__item-variant { font-size: var(--text-xs); color: var(--color-driftwood); }
  .drawer__item-price { font-size: var(--text-sm); color: var(--color-ink); margin-top: auto; }

  .drawer__foot {
    padding: var(--space-6) var(--space-8);
    border-top: 1px solid var(--color-stone);
  }
  .drawer__checkout {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    min-height: 52px;
    padding: var(--space-3) var(--space-8);
    font-family: var(--font-body);
    font-size: var(--text-2xs);
    font-weight: 500;
    letter-spacing: var(--tracking-widest);
    text-transform: uppercase;
    color: var(--color-parchment);
    background: var(--color-forest);
    text-decoration: none;
    transition: background var(--duration-normal) var(--ease-smooth);
  }
  .drawer__checkout:hover { background: var(--color-forest-light); opacity: 1; }

  @media (max-width: 1023px) {
    .pdp__info { padding-bottom: 88px; }
  }
{% endstylesheet %}

{% schema %}
{
  "name": "t:general.product",
  "settings": [
    {
      "type": "header",
      "content": "t:product.section_settings"
    },
    {
      "type": "checkbox",
      "id": "show_short_description",
      "label": "t:product.show_short_description",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_dynamic_checkout",
      "label": "t:product.show_dynamic_checkout",
      "default": true
    },
    {
      "type": "header",
      "content": "t:product.trust_badges"
    },
    {
      "type": "checkbox",
      "id": "show_trust_badges",
      "label": "t:product.show_trust_badges",
      "default": true
    },
    {
      "type": "text",
      "id": "trust_text_1",
      "label": "t:product.trust_text_1",
      "default": "Free shipping"
    },
    {
      "type": "text",
      "id": "trust_text_2",
      "label": "t:product.trust_text_2",
      "default": "Easy returns"
    },
    {
      "type": "text",
      "id": "trust_text_3",
      "label": "t:product.trust_text_3",
      "default": "5-year warranty"
    },
    {
      "type": "header",
      "content": "t:product.product_details"
    },
    {
      "type": "richtext",
      "id": "dimensions_text",
      "label": "t:product.dimensions"
    },
    {
      "type": "richtext",
      "id": "materials_text",
      "label": "t:product.materials"
    },
    {
      "type": "richtext",
      "id": "shipping_text",
      "label": "t:product.shipping_returns"
    },
    {
      "type": "richtext",
      "id": "care_text",
      "label": "t:product.care"
    }
  ],
  "disabled_on": {
    "groups": ["header", "footer"]
  }
}
{% endschema %}
